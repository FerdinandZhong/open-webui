---
# Configuration file for CML jobs
# Contains all job definitions and their parameters

jobs:
  # Git sync job to update repository code
  git_sync:
    name: "Git Repository Sync"
    script: ".git_sync.py"
    arguments: ""
    kernel: "python3"
    runtime_id: "docker.repository.cloudera.com/cloudera/cdsw/ml-runtime-pbj-jupyterlab-python3.11-standard:2025.09.1-b5"
    cpu: 1
    memory: 2
    gpu: 0
    timeout: 300
    environment:
      GITHUB_TOKEN: "${GITHUB_TOKEN}"  # Will be replaced at runtime

  create_env:
    name: Create Python Environment
    script: cai_integration/setup_environment.py
    kernel: python3
    runtime_id: "docker.repository.cloudera.com/cloudera/cdsw/ml-runtime-pbj-jupyterlab-python3.11-standard:2025.09.1-b5"
    cpu: 1
    memory: 2
    timeout: 1800  # 30 minutes
    environment: {}
    arguments: ""

  run_merged_app:
    name: "Run Merged App"
    script: "cai_integration/run_merged_app.py"
    kernel: "python3"
    runtime_id: "docker.repository.cloudera.com/cloudera/cdsw/ml-runtime-pbj-jupyterlab-python3.11-standard:2025.09.1-b5"
    cpu: 2
    memory: 8
    timeout: 3600  # 1 hour
    parent_job_key: "create_env"
    arguments: ""
    environment:
      OPENAI_API_KEY: "${OPENAI_API_KEY}"
